{% if site.post_search %}

<div id="beautifuljekyll-search-overlay">
  {% if page.lang == 'en' %}
  <div id="nav-search-exit" title="Close search">✕</div>
  <input type="text" id="nav-search-input" placeholder="Search articles">
  {% else %}
  <div id="nav-search-exit" title="Fermer la recherche">✕</div>
  <input type="text" id="nav-search-input" placeholder="Rechercher un article">
  {% endif %}
  <ul id="search-results-container"></ul>

  <script src="https://unpkg.com/simple-jekyll-search@latest/dest/simple-jekyll-search.min.js"></script>
  <script>
    // Detect current page language
    const currentLang = document.documentElement.lang || 
                       (window.location.pathname.startsWith('/en') ? 'en' : 'fr');
    
    // Configure search based on language
    const searchConfig = currentLang === 'en' ? {
      json: '{{ site.baseurl }}/assets/data/searchcorpus-en.json',
      noResultsText: 'No results found',
      dateLocale: 'en-US'
    } : {
      json: '{{ site.baseurl }}/assets/data/searchcorpus.json',
      noResultsText: 'Aucun résultat trouvé',
      dateLocale: 'fr-FR'
    };
    
    SimpleJekyllSearch({
      searchInput: document.getElementById('nav-search-input'),
      resultsContainer: document.getElementById('search-results-container'),
      json: searchConfig.json,
      noResultsText: searchConfig.noResultsText,
      searchResultTemplate: '<li><a href="{url}">{title}</a></li>',
      templateMiddleware: function(prop, value, template) {
        if (prop === 'date') {
          value = new Date(value).toLocaleDateString(searchConfig.dateLocale);
        }
        return value;
      }
    });
  </script>
</div>

{% endif %}
